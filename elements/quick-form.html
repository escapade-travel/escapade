<dom-module id="quick-form">
<style>
    section {
    }
    .screen-height {
        min-height: 100%;
    }
    .qfblock {
        padding-top: 40px;
    }
    .input-daterange input　{
        text-align: left;
    }

    .input-daterange .start-date {
        padding-left: 0;
    }

    .input-daterange .end-date {
        padding-right: 0;
    }

    input.form-control {
        box-sizing: border-box;
    }
    .row{
        margin-bottom: 15px;
        margin-top: 15px;
    }
    .theme span, .map-image span{
        margin: 5px;
    }
    .date-picker input{
        width: 100%;
        margin: 0 auto;
    }
    @media (max-width: 480px) {
        .input-group{
            width: 80%;
            margin: 0 auto;
            margin-bottom: 5px;
        }
    }

</style>

<template>

    <!-- Preloader -->

    <div id="preloader">
        <div id="status"></div>
    </div>

    <nav-element></nav-element>

    <section id="detail" class="qfblock screen-height">
        <div class="container text-center">
            <div class="row">
                <div class="col-sm-8 col-sm-offset-2 col-xs-10 col-xs-offset-1">

                    <div class="pfblock-subtitle">What do you need?</div>
                    <div class="pfblock-line"></div>

                    <form class="form-horizontal">
                        <div class="form-group">
                            <div class="col-sm-12">
                                <input type="text" class="form-control" id="themes"
                                       data-toggle="tooltip" data-placement="top" title="选择主题"
                                       placeholder="选择主题 (Not implemented yet)">
                            </div>
                        </div>
                        <div class="input-daterange">
                            <div class="form-group">
                                <div class="col-sm-12">
                                    <div class="col-xs-6 start-date">
                                        <input value="{{startDate::input}}" class="form-control" type="date" name="start-date" />
                                    </div>
                                    <div class="col-xs-6 end-date">
                                        <input value="{{endDate::input}}" class="form-control" type="date" name="end-date" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-12">
                                <input type="text" class="form-control" id="cities"
                                       data-toggle="tooltip" data-placement="top" title="选择城市"
                                       placeholder="选择城市 (Not implemented yet)"
                                        >
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-12">
                                <input id="min-budget" class="form-control" type="number" placeholder="Min budget per day"
                                       data-toggle="tooltip" data-placement="top" title="每日最低预算"
                                       pattern="[0-9]*" inputmode="numeric" value="{{minBudget::input}}"></input>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-12">
                                <input id="max-budget" class="form-control" type="number" placeholder="Max budget per day"
                                       data-toggle="tooltip" data-placement="top" title="每日最高预算"
                                       pattern="[0-9]*" inputmode="numeric" value="{{maxBudget::input}}"></input>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-12">
                                <textarea id="other-notes" value="{{otherNotes::input}}" class="form-control"
                                          placeholder="有什么其他要求" rows="7"></textarea>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-12">
                                <input type="text"  value="{{name::input}}"  class="form-control" id="name"
                                       data-toggle="tooltip" data-placement="top" title="姓名"
                                       placeholder="Your Name">
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-12">
                                <input type="email"  value="{{email::input}}"  class="form-control" id="email"
                                       data-toggle="tooltip" data-placement="top" title="Email"
                                       placeholder="Your Email">
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="col-sm-offset-1 col-sm-10">
                                <span class="btn btn-primary" on-click="goNext" data-current="detail" data-next="summary">Preview</span>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>


    <section id="summary" class="qfblock pfblock-gray screen-height" style="display:none">
        <div class="container text-center">
            <div class="row">
                <div class="col-sm-8 col-sm-offset-2 col-xs-10 col-xs-offset-1">
                    <div class="pfblock-header wow fadeInUp">
                        <div class="pfblock-subtitle">预览请求</div>
                        <div class="pfblock-line"></div>
                        <div class="summary">
                            <div class="panel panel-default">

                                <!-- Table -->
                                <table class="table table-hover text-left">
                                    <tr>
                                        <td><label>Name</label></td>
                                        <td>{{name}}</td>
                                    </tr>
                                    <tr>
                                        <td><label>Email</label></td>
                                        <td>{{email}}</td>
                                    </tr>
                                    <tr>
                                        <td><label>主题</label></td>
                                        <td id="selectedThemes"></td>
                                    </tr>
                                    <tr>
                                        <td><label>出行日期</label></td>
                                        <td><span>{{startDate}}</span></td>
                                    </tr>
                                    <tr>
                                        <td><label>返回日期</label></td>
                                        <td><span>{{endDate}}</span></td>
                                    </tr>
                                    <tr>
                                        <td><label>城市</label></td>
                                        <td id="selectedCities"></td>
                                    </tr>
                                    <tr>
                                        <td><label>消费预算</label></td>
                                        <td>&pound;<span>{{minBudget}}</span> to &pound;<span>{{maxBudget}}</span> per day</td>
                                    </tr>
                                    <tr>
                                        <td><label>其他要求</label></td>
                                        <td>{{otherNotes}}</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-sm-8 col-sm-offset-2 col-xs-10 col-xs-offset-1">
                    <span class="btn btn-default" on-click="goNext"
                          data-current="summary" data-next="detail">修改</span>
                    <span class="btn btn-primary" on-click="goNext"
                          data-current="summary" data-next="success">提交</span>
                </div>
            </div>
        </div>
    </section>

    <section id="success" class="pfblock pfblock-gray screen-height" style="display:none">
        <div class="container text-center">
            <div class="row">
                <div class="col-sm-8 col-sm-offset-2 col-xs-10 col-xs-offset-1">
                    <div class="pfblock-header wow fadeInUp">
                        <h1 class="pfblock-title">Request sent successfully</h1>
                        <div class="pfblock-line"></div>
                        <div class="pfblock-subtitle">Thanks XXX for your request. <br> We will contact you within xxx days. Just relax and have a nice day!</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- <contact-element></contact-element> -->

    <footer-element></footer-element>

</template>
<script>
Polymer({
    is: 'quick-form',
    properties: {
        themes: {
            type: Array,
            notify: true,
            value: [
                {
                    name: "历史",
                    selected: false
                },
                {
                    name: "文学",
                    selected: false
                },
                {
                    name: "流行音乐",
                    selected: false
                },
                {
                    name: "体育",
                    selected: false
                },
                {
                    name: "皇室",
                    selected: false
                },
                {
                    name: "风景",
                    selected: false
                },
                {
                    name: "英剧",
                    selected: false
                }
            ]
        },
        cities: {
            type: Array,
            notify: true,
            value: [
                {
                    name: "London",
                    selected: false
                },
                {
                    name: "Cambridge",
                    selected: false
                },
                {
                    name: "Oxford",
                    selected: false
                },
                {
                    name: "Bath",
                    selected: false
                },
                {
                    name: "York",
                    selected: false
                },
                {
                    name: "Manchester",
                    selected: false
                },
                {
                    name: "Edinburgh",
                    selected: false
                }
            ]
        },
        startDate:{
            type: String,
            notify: true,
            value: "Not decided"
        },
        endDate:{
            type: String,
            notify: true,
            value: "Not decided"
        },
        minBudget: {
            type: Number,
            notify: true,
            value: 100
        },
        maxBudget: {
            type: Number,
            notify: true,
            value: 200
        },
        otherNotes:{
            type: String,
            notify: true
        },
        email:{
            type: String,
            notify: true
        },
        name: {
            type: String,
            notify: true
        }
    },
    toggleSelection: function(e, detail){
        var item = e.model.item;
        var id = e.target.getAttribute('data-id');

        if(item.selected) {
            item.selected = false;
            e.target.classList.remove('active');
            e.target.classList.remove('btn-default');
            if(id == "selectedThemes"){
                e.target.classList.add('btn-primary');
            } else if(id == "selectedCities") {
                e.target.classList.add('btn-info');
            }
        } else {
            item.selected = true;
            e.target.classList.add('active');
            e.target.classList.add('btn-default');
            if(id == "selectedThemes"){
                e.target.classList.remove('btn-primary');
            } else if(id == "selectedCities") {
                e.target.classList.remove('btn-info');
            }
        }

        if(id == "selectedThemes"){
            this.selectedItems(this.themes, id);
        }

        if(id == "selectedCities"){
            this.selectedItems(this.cities, id);
        }
    },
    goNext: function(e, detail){
        var next_id = e.target.getAttribute('data-next');
        var current_id = e.target.getAttribute('data-current');
        if(next_id){
            document.getElementById(next_id).style.display = "block";
        }
        if(current_id){
            document.getElementById(current_id).style.display = "none";
        }

        window.scrollTo(0,0);
    },
    selectedItems: function(arr, id){
        var selected = "";

        for(var i=0; i<arr.length; i++){
            if(arr[i].selected){
                selected += arr[i].name + " ";
            }
        }

        this.$[id].innerHTML = selected;
    },
    ready: function(){
    },
    attached: function(){
        //$('[data-toggle="tooltip"]').tooltip();

        window.scrollTo(0,0);
        $('#status').fadeOut();
        $('#preloader').delay(300).fadeOut('slow');


        $(".screen-height").css("min-height", function(){
            return $(window).height();
        });

        $(window).resize(function() {
            $(".screen-height").css("min-height", function(){
                return $(window).height()
            });
        });


        /*Initialize price range slider*/
        /*
         var snapSlider = document.getElementById('price-slider');

         noUiSlider.create(snapSlider, {
         start: [ 200, 500 ],
         connect: true,
         range: {
         'min': [ 0 ],
         'max': [ 1000 ]
         }
         });

         var snapValues = [
         document.getElementById('slider-snap-value-lower'),
         document.getElementById('slider-snap-value-upper')
         ];

         snapSlider.noUiSlider.on('update', function( values, handle ) {
         snapValues[handle].innerHTML = values[handle];
         this.minBudget = values[0];
         this.maxBudget = values[1];

         console.log(this.minBudget);
         console.log(values[0]);
         console.log(values);
         });
         */

        if (!Modernizr.inputtypes.date) {
            // no native support for <input type="date"> :(
            /*Initialize datepicker*/
            $('.input-daterange').datepicker({});
        }

        /* ---------------------------------------------- /*
         * Smooth scroll / Scroll To Top
         /* ---------------------------------------------- */

        /*
         $('span[href*=#]').bind("click", function(e) {

         var anchor = $(this);
         $('html, body').stop().animate({
         scrollTop : $(anchor.attr('href')).offset().top
         }, 1000);
         e.preventDefault();
         });

         $(window).scroll(function() {
         if ($(this).scrollTop() > 100) {
         $('.scroll-up').fadeIn();
         } else {
         $('.scroll-up').fadeOut();
         }
         });
         */


        /* ---------------------------------------------- /*
         * Home BG
         /* ---------------------------------------------- */



        if (/Android|webOS|iPhone|iPad|iPod|BlackBerry/i
                .test(navigator.userAgent)) {
            $('#home').css({
                'background-attachment' : 'scroll'
            });
        } else {
            //$('#home').parallax('50%', 0.1);
        }
    }
});
</script>

</dom-module>
